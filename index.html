<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hasil Seleksi PSB Al-Bahjah</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #E63946;
            --teal: #2A9D8F;
            --yellow: #F1C40F;
            --navy: #1D3557;
            --bg-light: #F1FAEE;
            --border: #1D3557;
            --shadow: #1D3557;
            --text-main: #1D3557;
            --text-muted: #457B9D;
        }

        .dark {
            --bg-light: #0d1b2a;
            --border: #F1FAEE;
            --shadow: #F1FAEE;
            --text-main: #FFFFFF;
            --text-muted: #A8DADC;
            --navy: #F1FAEE;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: var(--bg-light);
            background-image: radial-gradient(var(--border) 0.5px, transparent 0.5px);
            background-size: 16px 16px;
            color: var(--text-main);
            transition: background-color 0.5s cubic-bezier(0.4, 0, 0.2, 1), color 0.5s ease;
        }

        .neo-box {
            border: 3px solid var(--border);
            box-shadow: 5px 5px 0 var(--shadow);
            background: white;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dark .neo-box {
            background: #112233;
            color: white;
        }

        .btn-neo {
            border: 3px solid var(--border);
            box-shadow: 4px 4px 0 var(--shadow);
            font-weight: 800;
            text-transform: uppercase;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-neo:hover:not(:disabled) {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 var(--shadow);
        }

        .btn-neo:active:not(:disabled) {
            transform: translate(4px, 4px);
            box-shadow: 0px 0px 0 var(--shadow);
        }

        .input-neo {
            border: 3px solid var(--border);
            padding: 10px;
            font-weight: 700;
            color: #1D3557;
            transition: all 0.3s ease;
        }

        .input-neo:focus {
            box-shadow: 4px 4px 0 var(--shadow);
            transform: translate(-2px, -2px);
            outline: none;
        }

        .dark .input-neo {
            background: #0d1b2a;
            color: white;
        }

        @keyframes slideUpFade {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-reveal {
            animation: slideUpFade 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }

        .loading-dots::after {
            content: '.';
            animation: dots 1.5s steps(5, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: ''; }
        }

        .label-text {
            font-size: 9px;
            font-weight: 800;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .value-text {
            font-weight: 800;
            color: var(--text-main);
        }

        @media print {
            .no-print {
                display: none;
            }
            body {
                background: white;
                color: black;
                background-image: none;
            }
            .neo-box {
                box-shadow: none;
                border: 2px solid black;
            }
        }
    </style>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@300;400;500;600;700&display=swap">
</head>

<body class="min-h-screen flex flex-col items-center pt-10 pr-4 pb-10 pl-4">

    <!-- Toggle Mode -->
    <div class="fixed top-4 right-4 no-print z-50">
        <button onclick="toggleDarkMode()" class="btn-neo flex bg-[#2A9D8F] rounded-none p-1.5 items-center justify-center">
            <span id="themeIcon" class="text-xl font-geist-mono">üåô</span>
        </button>
    </div>

    <div class="w-full max-w-md">

        <!-- Header -->
        <header class="text-center mb-10">
            <!-- Logo Section -->
            <div class="flex justify-center mb-6">
                <div class="neo-box bg-white p-2 rounded-none">
                   <img src="https://raw.githubusercontent.com/yusufpazuruan/portal-psb/main/logosmaiqu.svg" alt="Logo SMAIQU" class="h-20 w-auto">
                </div>
            </div>
            
            <div class="neo-box bg-[#A8DADC] inline-block px-6 py-2 mb-4">
                <h1 class="text-xl font-extrabold font-geist-mono" style="color: var(--navy);">PSB AL-BAHJAH</h1>
            </div>
            <p class="text-[10px] font-bold uppercase tracking-[0.2em] opacity-80 font-geist-mono">Portal Hasil Seleksi Pendidikan Formal</p>
        </header>

        <!-- Search -->
        <div id="searchSection" class="neo-box p-6 mb-6">
            <label class="block text-[10px] font-black mb-3 uppercase tracking-tight font-geist-mono">Masukkan No. Registrasi</label>
            <input id="regInput" type="text" placeholder="Contoh: 20260238" class="input-neo w-full mb-4 text-sm bg-white">
            <button onclick="checkResult()" id="btnSearch" class="btn-neo bg-[#2A9D8F] text-white w-full py-4 text-sm tracking-widest">
                <span id="btnText" class="font-geist-mono">LIHAT HASIL TEST</span>
            </button>
        </div>

        <!-- Result Area -->
        <div id="resultArea" class="hidden">
            <div class="neo-box overflow-hidden animate-reveal">
                <!-- Dynamic Greeting Section -->
                <div id="greetingContent" class="p-5 text-[10px] leading-relaxed font-bold border-b-2 border-dashed border-gray-400 bg-gray-50 dark:bg-[#112233] text-[#1D3557] dark:text-white transition-colors duration-300">
                </div>

                <!-- Result Banner -->
                <div id="bannerHasil" class="p-6 text-center transition-all duration-500">
                    <span id="labelHasil" class="text-4xl font-black italic uppercase tracking-tighter"></span>
                </div>

                <!-- Student Data -->
                <div class="p-6 space-y-4">
                    <div class="flex justify-between items-end border-b-2 border-gray-100 dark:border-gray-700 pb-2">
                        <span class="label-text font-geist-mono">Nama Lengkap</span>
                        <span id="resNama" class="value-text text-xs uppercase font-geist-mono">-</span>
                    </div>
                    <div class="flex justify-between items-end border-b-2 border-gray-100 dark:border-gray-700 pb-2">
                        <span class="label-text font-geist-mono">No. Regis</span>
                        <span id="resReg" class="value-text text-xs font-geist-mono">-</span>
                    </div>
                    <div class="flex justify-between items-end border-b-2 border-gray-100 dark:border-gray-700 pb-2">
                        <span class="label-text font-geist-mono">Asal Sekolah</span>
                        <span id="resAsal" class="value-text text-[10px] text-right max-w-[60%] font-geist-mono">-</span>
                    </div>
                    <div class="flex justify-between items-end border-b-2 border-gray-100 dark:border-gray-700 pb-2">
                        <span class="label-text font-geist-mono">Unit Penempatan</span>
                        <span id="resTempat" class="value-text text-[10px] text-right text-[#2A9D8F] dark:text-[#49e0d0] font-geist-mono">-</span>
                    </div>
                    <div class="flex justify-between items-end">
                        <span class="label-text font-geist-mono">Jenis Kelamin</span>
                        <span id="resJK" class="value-text text-[10px] uppercase font-geist-mono">-</span>
                    </div>
                </div>

                <!-- WhatsApp Notification -->
                <div id="waNotif" class="hidden mx-5 mb-5 p-4 bg-green-50 border-2 border-green-600 dark:bg-green-900/20 dark:border-green-400">
                    <div class="flex items-start gap-3">
                        <span class="text-xl">üì©</span>
                        <div>
                            <p class="text-[10px] font-black text-green-800 dark:text-green-300 uppercase mb-1 font-geist-mono">Dokumen SK Telah Dikirim</p>
                            <p class="text-[9px] text-green-700 dark:text-green-400 leading-tight font-geist-mono">File PDF Surat Keputusan (SK) kelulusan resmi telah dikirimkan secara otomatis ke nomor yang terdaftar.</p>
                        </div>
                    </div>
                </div>

                <!-- Download Files Section (Only for Lulus) -->
                <div id="downloadSection" class="hidden mx-5 mb-5 p-4 border-2 border-dashed border-[#1D3557] dark:border-white/30 bg-yellow-50 dark:bg-yellow-900/10">
                    <p class="text-[10px] font-black uppercase mb-3 font-geist-mono">Unduh Berkas Administrasi:</p>
                    <div class="grid gap-2">
                        <a href="https://drive.google.com/file/d/1Dq_vJY1SmXzfE5d6mc3ZWUBQmTK1aJGL/view?usp=drive_link" target="_blank" class="flex items-center justify-between p-2 bg-white dark:bg-[#1d3557] border-2 border-[#1d3557] hover:bg-gray-100 transition-colors">
                            <span class="text-[9px] font-bold font-geist-mono uppercase">Pakta Integritas Wali</span>
                            <span class="text-lg">üìÑ</span>
                        </a>
                        <a href="https://drive.google.com/file/d/1QXPFpoDcFv95fTN45570HgxMV015Obtf/view?usp=drive_link" target="_blank" class="flex items-center justify-between p-2 bg-white dark:bg-[#1d3557] border-2 border-[#1d3557] hover:bg-gray-100 transition-colors">
                            <span class="text-[9px] font-bold font-geist-mono uppercase">Pakta Integritas Santri</span>
                            <span class="text-lg">üìÑ</span>
                        </a>
                    </div>
                </div>

                <!-- Footer Sign -->
                <div class="p-5 text-[9px] bg-gray-50 dark:bg-[#112233] border-t-2 border-dashed border-gray-400 transition-colors duration-300">
                    <div class="text-right font-black uppercase text-[#1D3557] dark:text-white mb-4 font-geist-mono">
                        Pendidikan Formal Al-Bahjah<br>Panitia PSB
                    </div>
                    <p class="text-center font-black uppercase text-sm tracking-tight border-t border-gray-200 dark:border-gray-700 pt-4 font-geist-mono">
                        Wassalamu'alaikum Warahmatullahi Wabarakatuh
                    </p>
                </div>
            </div>
        </div>

        <!-- Error Area -->
        <div id="errorArea" class="hidden neo-box bg-[#E63946] p-8 text-center text-white animate-reveal">
            <p class="text-base font-black uppercase tracking-widest font-geist-mono">Data Tidak Ditemukan</p>
            <p class="text-[10px] mt-2 font-bold opacity-80 font-geist-mono">Mohon periksa kembali nomor registrasi Anda dengan teliti.</p>
        </div>

        <footer class="mt-12 text-center text-[10px] font-bold tracking-widest opacity-40 no-print uppercase font-geist-mono">
            Pendidikan Formal Al-Bahjah ¬© 2026
        </footer>
    </div>

    <script>
        const apiUrl = "https://script.google.com/macros/s/AKfycbxeoMEt5hNYPK2XvvE71TWMxvzSminc-FXGECXyzhpIsr7EVsQxJn_or1Tx5L-zQ-6E/exec?noregis=";
        const regInput = document.getElementById('regInput');

        function toggleDarkMode() {
            document.body.classList.toggle('dark');
            const icon = document.getElementById('themeIcon');
            icon.innerText = document.body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
        }

        async function checkResult() {
            const noregis = regInput.value.trim();
            if (!noregis) return;

            const btnSearch = document.getElementById('btnSearch');
            const btnText = document.getElementById('btnText');
            const resultArea = document.getElementById('resultArea');
            const errorArea = document.getElementById('errorArea');

            btnSearch.disabled = true;
            btnText.innerHTML = 'MENCARI DATA<span class="loading-dots"></span>';
            
            resultArea.classList.add('hidden');
            errorArea.classList.add('hidden');
            
            try {
                const res = await fetch(apiUrl + noregis);
                const json = await res.json();

                if (json.status && json.data) {
                    showData(json.data);
                } else {
                    errorArea.classList.remove('hidden');
                }
            } catch {
                errorArea.classList.remove('hidden');
            } finally {
                btnSearch.disabled = false;
                btnText.innerText = 'LIHAT HASIL TEST';
            }
        }

        function showData(data) {
            const resNama = document.getElementById('resNama');
            const resReg = document.getElementById('resReg');
            const resJK = document.getElementById('resJK');
            const resAsal = document.getElementById('resAsal');
            const resTempat = document.getElementById('resTempat');
            const labelHasil = document.getElementById('labelHasil');
            const bannerHasil = document.getElementById('bannerHasil');
            const resultArea = document.getElementById('resultArea');
            const greetingContent = document.getElementById('greetingContent');
            const waNotif = document.getElementById('waNotif');
            const downloadSection = document.getElementById('downloadSection');

            const isLulus = data["HASIL"].toUpperCase() === 'LULUS';

            resNama.innerText = data["NAMA LENGKAP"];
            resReg.innerText = data["NO REGIS"];
            resJK.innerText = data["JENIS KELAMIN"];
            resAsal.innerText = data["ASAL SEKOLAH"] || '-';
            resTempat.innerText = data["DITEMPATKAN DI"];
            labelHasil.innerText = data["HASIL"];

            if (isLulus) {
                bannerHasil.style.backgroundColor = 'var(--teal)';
                labelHasil.style.color = 'var(--yellow)';
                waNotif.classList.remove('hidden');
                downloadSection.classList.remove('hidden');
                greetingContent.innerHTML = `
                    Assalamu'alaikum Warahmatullahi Wabarakatuh<br><br>
                    Kami Panitia Penerimaan Pendidikan Formal Al-Bahjah memberitahukan bahwa berdasarkan hasil seleksi Penerimaan Santri Baru, ananda dinyatakan <span class="bg-teal-600 text-white px-1">DITERIMA</span>.<br><br>
                    Semoga ini menjadi awal yang baik dan penuh keberkahan bagi ananda dalam menuntut ilmu.<br><br>
                    Informasi mengenai daftar ulang akan kami sampaikan pada notifikasi selanjutnya. <b>Jazakumullah khairan katsiran.</b>
                `;
            } else {
                bannerHasil.style.backgroundColor = 'var(--primary)';
                labelHasil.style.color = 'white';
                waNotif.classList.add('hidden');
                downloadSection.classList.add('hidden');
                greetingContent.innerHTML = `
                    Assalamu'alaikum Warahmatullahi Wabarakatuh<br><br>
                    Kami Panitia Penerimaan Pendidikan Formal Al-Bahjah memberitahukan hasil seleksi sebagai berikut:
                `;
            }

            resultArea.classList.remove('hidden');
            resultArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        regInput.addEventListener('keypress', e => {
            if (e.key === 'Enter') checkResult();
        });
    </script>
</body>

</html>
